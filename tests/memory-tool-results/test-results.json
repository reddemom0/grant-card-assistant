{
  "timestamp": "2025-10-15T14:18:04.532Z",
  "totalTests": 27,
  "passed": 27,
  "failed": 0,
  "skipped": 0,
  "tests": [
    {
      "name": "Path Validation: Valid path accepted",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.536Z",
      "input": "/memories/test/example.xml",
      "output": "/Users/Chris/grant-card-assistant/memories/test/example.xml",
      "expectedBase": "/Users/Chris/grant-card-assistant/memories"
    },
    {
      "name": "Path Validation: Reject invalid prefix",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.536Z",
      "expectedError": "Invalid path: must start with /memories",
      "actualError": "Invalid path: must start with /memories"
    },
    {
      "name": "Path Validation: Reject traversal attack",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.536Z",
      "expectedError": "Path traversal detected",
      "actualError": "Path traversal detected"
    },
    {
      "name": "CREATE: New file created successfully",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.537Z",
      "path": "/memories/test/unit-test-create.xml",
      "result": {
        "success": true,
        "message": "Created /memories/test/unit-test-create.xml"
      }
    },
    {
      "name": "VIEW: Read existing file successfully",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.538Z",
      "path": "/memories/test/unit-test-create.xml",
      "expectedContent": "<test>Hello World</test>",
      "actualContent": "<test>Hello World</test>"
    },
    {
      "name": "VIEW: Handle file not found",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.538Z",
      "expectedSuccess": false,
      "actualSuccess": false,
      "error": "File not found: /memories/test/nonexistent-file.xml"
    },
    {
      "name": "STR_REPLACE: Update file successfully",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.538Z",
      "path": "/memories/test/unit-test-create.xml",
      "expectedContent": "<test>Hello Memory Tool</test>",
      "actualContent": "<test>Hello Memory Tool</test>"
    },
    {
      "name": "STR_REPLACE: Handle string not found",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.538Z",
      "expectedSuccess": false,
      "actualSuccess": false,
      "error": "String not found in file: \"Nonexistent String\""
    },
    {
      "name": "INSERT: Insert content at line",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.540Z",
      "path": "/memories/test/unit-test-insert.xml",
      "expectedContent": "Line 1\nInserted Line\nLine 2\nLine 3",
      "actualContent": "Line 1\nInserted Line\nLine 2\nLine 3"
    },
    {
      "name": "RENAME: Move/rename file successfully",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.540Z",
      "oldPath": "/memories/test/unit-test-create.xml",
      "newPath": "/memories/test/unit-test-renamed.xml",
      "newFileExists": true,
      "oldFileRemoved": true
    },
    {
      "name": "DELETE: Remove file successfully",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.541Z",
      "path": "/memories/test/unit-test-renamed.xml",
      "fileDeleted": true
    },
    {
      "name": "CREATE: Enforce file size limit",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.541Z",
      "expectedSuccess": false,
      "actualSuccess": false,
      "contentSize": 2097152,
      "error": "Content exceeds maximum file size (1048576 bytes)"
    },
    {
      "name": "CREATE: Prevent duplicate file creation",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "expectedSuccess": false,
      "actualSuccess": false,
      "error": "File already exists: /memories/test/unit-test-duplicate.xml. Use str_replace to modify."
    },
    {
      "name": "Security: Block path traversal with ../",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "attemptedPath": "/memories/../../../etc/passwd",
      "blocked": true,
      "error": "Path traversal detected"
    },
    {
      "name": "Security: Block absolute path outside memory",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "attemptedPath": "/etc/passwd",
      "blocked": true,
      "error": "Invalid path: must start with /memories"
    },
    {
      "name": "Security: Block symbolic link traversal",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "attemptedPath": "/memories/test/../../outside.xml",
      "blocked": true,
      "error": "Path traversal detected"
    },
    {
      "name": "Security: Block command injection in path",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "attemptedPath": "/memories/test/; rm -rf /",
      "blocked": true
    },
    {
      "name": "Security: Block null byte injection",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "attemptedPath": "/memories/test/file.xml\\0malicious",
      "blocked": true
    },
    {
      "name": "API: Memory tool definition structure",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "expectedCommands": [
        "view",
        "create",
        "str_replace",
        "insert",
        "delete",
        "rename"
      ],
      "note": "Manual verification required - MEMORY_TOOL not exported from server.js"
    },
    {
      "name": "API: processMemoryToolUse detects memory blocks",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.542Z",
      "totalBlocks": 3,
      "memoryBlocks": 1,
      "memoryBlockId": "toolu_test123"
    },
    {
      "name": "API: Tool result format is correct",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.543Z",
      "resultKeys": [
        "success",
        "message"
      ],
      "expectedKeys": [
        "success",
        "message or error"
      ],
      "result": {
        "success": true,
        "message": "Created /memories/test/api-integration-test.xml"
      }
    },
    {
      "name": "API: Beta headers configured",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.543Z",
      "expectedHeaders": "files-api-2025-04-14,context-management-2025-06-27",
      "note": "Manual verification required"
    },
    {
      "name": "Persistence: Memory survives process restart",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.543Z",
      "path": "/memories/test/persistence-test.xml",
      "expectedContent": "<persistence>Memory should persist</persistence>",
      "actualContent": "<persistence>Memory should persist</persistence>",
      "note": "Simulated - full test requires process restart"
    },
    {
      "name": "Persistence: Learning from corrections pattern",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.544Z",
      "path": "/memories/user_feedback/corrections.xml",
      "correctionFound": true,
      "note": "Pattern works - agent would check this at conversation start"
    },
    {
      "name": "Persistence: Multi-day project tracking pattern",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.545Z",
      "path": "/memories/projects/active/test-project.xml",
      "projectFound": true,
      "nextStepsPreserved": true,
      "note": "Pattern works - agent can resume from saved state"
    },
    {
      "name": "Organization: All directory categories work",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.547Z",
      "testedDirectories": 7,
      "allCreated": true
    },
    {
      "name": "Organization: File naming conventions work",
      "passed": true,
      "timestamp": "2025-10-15T14:18:04.548Z",
      "testedNames": 4,
      "allValid": true
    }
  ]
}